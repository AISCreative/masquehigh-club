<!-- PANEL DE ADMINISTRACI√ìN PARA TABLET - CONTRASE√ëA: situs123 -->
<div style="position: fixed; bottom: 30px; right: 30px; z-index: 2000;">
  <button id="btn-admin" onclick="mostrarLogin()" style="width: 70px; height: 70px; border-radius: 50%; background: #00ff9f; border: 4px solid #ff18d0; color: black; font-size: 30px; box-shadow: 0 0 30px #00ff9f; cursor: pointer;">‚öôÔ∏è</button>
</div>

<!-- PANEL LOGIN -->
<div id="panel-login" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 2001; align-items: center; justify-content: center;">
  <div style="background: #0b0c14; border: 4px solid #00ff9f; border-radius: 40px; padding: 40px; width: 90%; max-width: 500px; box-shadow: 0 0 60px #ff18d0;">
    <h2 style="color: #00ff9f; text-align: center; font-size: 3rem; margin-bottom: 30px;">üîê ADMIN</h2>
    <input type="password" id="login-password" placeholder="Contrase√±a" style="width: 100%; padding: 25px; font-size: 2rem; background: #1a1a2a; border: 3px solid #ff18d0; border-radius: 30px; color: white; margin-bottom: 30px; text-align: center;">
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
      <button onclick="comprobarLogin()" style="background: #00ff9f; border: none; border-radius: 30px; padding: 25px; font-size: 2rem; font-weight: bold; cursor: pointer;">ENTRAR</button>
      <button onclick="cerrarLogin()" style="background: #ff18d0; border: none; border-radius: 30px; padding: 25px; font-size: 2rem; font-weight: bold; color: white; cursor: pointer;">CERRAR</button>
    </div>
    <p id="login-error" style="color: #ff18d0; text-align: center; font-size: 1.8rem; margin-top: 20px; display: none;">‚ùå Contrase√±a incorrecta</p>
  </div>
</div>

<!-- PANEL ADMIN PRINCIPAL -->
<div id="panel-admin" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0b0c14; z-index: 2002; overflow-y: auto; padding: 30px;">
  
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 4px solid #00ff9f; padding-bottom: 20px;">
    <h1 style="color: #00ff9f; font-size: 3.5rem;">‚úèÔ∏è EDITAR CAT√ÅLOGO</h1>
    <button onclick="cerrarAdmin()" style="background: #ff18d0; border: none; border-radius: 60px; padding: 20px 40px; font-size: 2.2rem; color: white; cursor: pointer;">CERRAR</button>
  </div>
  
  <!-- Pesta√±as principales del admin -->
  <div style="display: flex; gap: 20px; margin-bottom: 30px;">
    <button id="admin-tab-productos" onclick="cambiarTabAdmin('productos')" style="flex: 1; background: #00ff9f; border: none; border-radius: 30px; padding: 20px; font-size: 2.2rem; font-weight: bold; cursor: pointer;">üì¶ PRODUCTOS</button>
    <button id="admin-tab-munchies" onclick="cambiarTabAdmin('munchies')" style="flex: 1; background: #333; border: none; border-radius: 30px; padding: 20px; font-size: 2.2rem; color: white; cursor: pointer;">üç∫ MUNCHIES</button>
    <button id="admin-tab-eventos" onclick="cambiarTabAdmin('eventos')" style="flex: 1; background: #333; border: none; border-radius: 30px; padding: 20px; font-size: 2.2rem; color: white; cursor: pointer;">üéâ EVENTOS</button>
  </div>
  
  <!-- PANEL DE PRODUCTOS -->
  <div id="admin-productos" style="display: block;">
    
    <!-- Subpesta√±as dentro de productos -->
    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
      <button id="subtab-extract" onclick="cambiarSubTab('extract')" style="flex: 1; background: #00ff9f; border: none; border-radius: 20px; padding: 15px; font-size: 1.8rem; font-weight: bold; cursor: pointer;">‚ö° EXTRACCI√ìN</button>
      <button id="subtab-hierbas" onclick="cambiarSubTab('hierbas')" style="flex: 1; background: #333; border: none; border-radius: 20px; padding: 15px; font-size: 1.8rem; color: white; cursor: pointer;">üåø HIERBAS</button>
      <button id="subtab-liados" onclick="cambiarSubTab('liados')" style="flex: 1; background: #333; border: none; border-radius: 20px; padding: 15px; font-size: 1.8rem; color: white; cursor: pointer;">üö¨ LIADOS</button>
    </div>
    
    <!-- Contenedor de extracci√≥n -->
    <div id="admin-extract" style="display: block;">
      <div id="extract-editables" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px;"></div>
      <button onclick="anadirProductoEn('extract')" style="width: 100%; background: #00ff9f; border: none; border-radius: 40px; padding: 30px; font-size: 2.5rem; margin-top: 20px; cursor: pointer;">‚ûï A√ëADIR PRODUCTO A EXTRACCI√ìN</button>
    </div>
    
    <!-- Contenedor de hierbas -->
    <div id="admin-hierbas" style="display: none;">
      <div id="hierbas-editables" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px;"></div>
      <button onclick="anadirProductoEn('hierbas')" style="width: 100%; background: #00ff9f; border: none; border-radius: 40px; padding: 30px; font-size: 2.5rem; margin-top: 20px; cursor: pointer;">‚ûï A√ëADIR PRODUCTO A HIERBAS</button>
    </div>
    
    <!-- Contenedor de liados -->
    <div id="admin-liados" style="display: none;">
      <div id="liados-editables" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px;"></div>
      <button onclick="anadirProductoEn('liados')" style="width: 100%; background: #ffff00; border: none; border-radius: 40px; padding: 30px; font-size: 2.5rem; margin-top: 20px; cursor: pointer;">‚ûï A√ëADIR PRODUCTO A LIADOS</button>
    </div>
    
  </div>
  
  <!-- PANEL DE MUNCHIES -->
  <div id="admin-munchies" style="display: none;">
    
    <!-- Subpesta√±as dentro de munchies -->
    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
      <button id="subtab-refrescos" onclick="cambiarSubTabMunchies('refrescos')" style="flex: 1; background: #ff18d0; border: none; border-radius: 20px; padding: 15px; font-size: 1.8rem; font-weight: bold; color: white; cursor: pointer;">ü•§ REFRESCOS</button>
      <button id="subtab-picar" onclick="cambiarSubTabMunchies('picar')" style="flex: 1; background: #333; border: none; border-radius: 20px; padding: 15px; font-size: 1.8rem; color: white; cursor: pointer;">üçü PARA PICAR</button>
    </div>
    
    <!-- Contenedor de refrescos -->
    <div id="admin-refrescos" style="display: block;">
      <div id="refrescos-editables" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px;"></div>
      <button onclick="anadirMunchiEn('refrescos')" style="width: 100%; background: #ff18d0; border: none; border-radius: 40px; padding: 30px; font-size: 2.5rem; margin-top: 20px; color: white; cursor: pointer;">‚ûï A√ëADIR REFRESCO</button>
    </div>
    
    <!-- Contenedor de picar -->
    <div id="admin-picar" style="display: none;">
      <div id="picar-editables" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px;"></div>
      <button onclick="anadirMunchiEn('picar')" style="width: 100%; background: #ff18d0; border: none; border-radius: 40px; padding: 30px; font-size: 2.5rem; margin-top: 20px; color: white; cursor: pointer;">‚ûï A√ëADIR PRODUCTO</button>
    </div>
    
  </div>
  
  <!-- PANEL DE EVENTOS -->
  <div id="admin-eventos" style="display: none;">
    <div id="eventos-editables" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px;"></div>
    <button onclick="anadirEvento()" style="width: 100%; background: #ffff00; border: none; border-radius: 40px; padding: 30px; font-size: 2.5rem; margin-top: 20px; cursor: pointer;">‚ûï A√ëADIR CARTEL DE EVENTO</button>
  </div>
  
  <!-- Bot√≥n guardar todo -->
  <div style="position: sticky; bottom: 30px; margin-top: 40px;">
    <button onclick="guardarTodo()" style="width: 100%; background: #00ff9f; border: 4px solid #ff18d0; border-radius: 60px; padding: 30px; font-size: 3rem; font-weight: bold; box-shadow: 0 0 40px #00ff9f; cursor: pointer;">üíæ GUARDAR TODOS LOS CAMBIOS</button>
  </div>
  
</div>

<input type="file" id="selector-imagen" accept="image/*" style="display: none;">

<script>
// ===== CONFIGURACI√ìN =====
const CONTRASENA = "situs123";
let productoEditando = null;
let currentSeccion = 'extract';

// ===== LOGIN =====
function mostrarLogin() {
  document.getElementById('panel-login').style.display = 'flex';
}
function cerrarLogin() {
  document.getElementById('panel-login').style.display = 'none';
}
function comprobarLogin() {
  const pass = document.getElementById('login-password').value;
  if (pass === CONTRASENA) {
    document.getElementById('panel-login').style.display = 'none';
    abrirAdmin();
  } else {
    document.getElementById('login-error').style.display = 'block';
  }
}

// ===== ADMIN =====
function abrirAdmin() {
  document.getElementById('panel-admin').style.display = 'block';
  cargarTodosLosDatos();
}
function cerrarAdmin() {
  document.getElementById('panel-admin').style.display = 'none';
  document.getElementById('login-password').value = '';
}

function cambiarTabAdmin(tab) {
  // Ocultar todos los paneles principales
  document.getElementById('admin-productos').style.display = 'none';
  document.getElementById('admin-munchies').style.display = 'none';
  document.getElementById('admin-eventos').style.display = 'none';
  
  // Resetear colores de pesta√±as
  document.getElementById('admin-tab-productos').style.background = '#333';
  document.getElementById('admin-tab-munchies').style.background = '#333';
  document.getElementById('admin-tab-eventos').style.background = '#333';
  
  // Mostrar el seleccionado
  if (tab === 'productos') {
    document.getElementById('admin-productos').style.display = 'block';
    document.getElementById('admin-tab-productos').style.background = '#00ff9f';
    cargarProductos();
  } else if (tab === 'munchies') {
    document.getElementById('admin-munchies').style.display = 'block';
    document.getElementById('admin-tab-munchies').style.background = '#ff18d0';
    cargarMunchies();
  } else if (tab === 'eventos') {
    document.getElementById('admin-eventos').style.display = 'block';
    document.getElementById('admin-tab-eventos').style.background = '#ffff00';
    cargarEventos();
  }
}

function cambiarSubTab(subtab) {
  // Ocultar todos
  document.getElementById('admin-extract').style.display = 'none';
  document.getElementById('admin-hierbas').style.display = 'none';
  document.getElementById('admin-liados').style.display = 'none';
  
  // Resetear colores
  document.getElementById('subtab-extract').style.background = '#333';
  document.getElementById('subtab-hierbas').style.background = '#333';
  document.getElementById('subtab-liados').style.background = '#333';
  
  // Mostrar el seleccionado
  if (subtab === 'extract') {
    document.getElementById('admin-extract').style.display = 'block';
    document.getElementById('subtab-extract').style.background = '#00ff9f';
    currentSeccion = 'extract';
    cargarExtract();
  } else if (subtab === 'hierbas') {
    document.getElementById('admin-hierbas').style.display = 'block';
    document.getElementById('subtab-hierbas').style.background = '#00ff9f';
    currentSeccion = 'hierbas';
    cargarHierbas();
  } else if (subtab === 'liados') {
    document.getElementById('admin-liados').style.display = 'block';
    document.getElementById('subtab-liados').style.background = '#ffff00';
    currentSeccion = 'liados';
    cargarLiados();
  }
}

function cambiarSubTabMunchies(subtab) {
  document.getElementById('admin-refrescos').style.display = 'none';
  document.getElementById('admin-picar').style.display = 'none';
  
  document.getElementById('subtab-refrescos').style.background = '#333';
  document.getElementById('subtab-picar').style.background = '#333';
  
  if (subtab === 'refrescos') {
    document.getElementById('admin-refrescos').style.display = 'block';
    document.getElementById('subtab-refrescos').style.background = '#ff18d0';
    cargarRefrescos();
  } else {
    document.getElementById('admin-picar').style.display = 'block';
    document.getElementById('subtab-picar').style.background = '#ff18d0';
    cargarPicar();
  }
}

// ===== CARGAR DATOS =====
function cargarTodosLosDatos() {
  cargarExtract();
  cargarHierbas();
  cargarLiados();
  cargarRefrescos();
  cargarPicar();
  cargarEventos();
}

function cargarExtract() {
  let html = '';
  document.querySelectorAll('#panel-genero .subseccion:first-child .producto-card').forEach((card, index) => {
    html += generarCardProducto(card, index, 'extract');
  });
  document.getElementById('extract-editables').innerHTML = html;
}

function cargarHierbas() {
  let html = '';
  document.querySelectorAll('#panel-genero .subseccion:nth-child(2) .producto-card').forEach((card, index) => {
    html += generarCardProducto(card, index, 'hierbas');
  });
  document.getElementById('hierbas-editables').innerHTML = html;
}

function cargarLiados() {
  let html = '';
  document.querySelectorAll('#panel-genero .subseccion:nth-child(3) .producto-card').forEach((card, index) => {
    const img = card.querySelector('img');
    const tieneImagen = img !== null;
    const nombre = card.querySelector('h4').textContent;
    const precio = card.querySelector('.producto-precio').textContent;
    
    html += `
      <div style="background: #1a1a2a; border: 3px solid #ffff00; border-radius: 30px; padding: 25px;">
        <div style="text-align: center; margin-bottom: 15px;">
          <div style="width: 150px; height: 150px; border-radius: 50%; border: 4px solid #ffff00; background: #000; margin: 0 auto; display: flex; align-items: center; justify-content: center; color: #ffff00; font-size: 3rem;">üö¨</div>
          <div style="margin-top: 10px; color: #ffff00;">SIN IMAGEN</div>
        </div>
        <label style="color: white; font-size: 1.8rem;">Nombre:</label>
        <input type="text" id="liados-nombre-${index}" value="${nombre}" style="width: 100%; padding: 15px; font-size: 1.8rem; background: #000; border: 2px solid #00ff9f; border-radius: 20px; color: white; margin-bottom: 15px;">
        <label style="color: white; font-size: 1.8rem;">Precio:</label>
        <input type="text" id="liados-precio-${index}" value="${precio}" style="width: 100%; padding: 15px; font-size: 1.8rem; background: #000; border: 2px solid #ff18d0; border-radius: 20px; color: #00ff9f; margin-bottom: 15px;">
        <button onclick="eliminarProducto('liados', ${index})" style="width: 100%; background: #ff18d0; border: none; border-radius: 20px; padding: 15px; font-size: 1.8rem; color: white; cursor: pointer;">üóëÔ∏è ELIMINAR</button>
      </div>
    `;
  });
  document.getElementById('liados-editables').innerHTML = html;
}

function generarCardProducto(card, index, seccion) {
  const img = card.querySelector('img');
  const imgSrc = img ? img.src : '';
  const nombre = card.querySelector('h4').textContent;
  const precio = card.querySelector('.producto-precio').textContent;
  
  return `
    <div style="background: #1a1a2a; border: 3px solid #00ff9f; border-radius: 30px; padding: 25px;">
      <div style="text-align: center; margin-bottom: 15px;">
        <img id="preview-${seccion}-${index}" src="${imgSrc}" style="width: 150px; height: 150px; border-radius: 50%; border: 4px solid #ff18d0; object-fit: cover; cursor: pointer;" onclick="seleccionarImagen('${seccion}', ${index})">
        <div style="margin-top: 10px; color: #00ff9f;">üëá TOCA LA IMAGEN</div>
      </div>
      <label style="color: white; font-size: 1.8rem;">Nombre:</label>
      <input type="text" id="${seccion}-nombre-${index}" value="${nombre}" style="width: 100%; padding: 15px; font-size: 1.8rem; background: #000; border: 2px solid #00ff9f; border-radius: 20px; color: white; margin-bottom: 15px;">
      <label style="color: white; font-size: 1.8rem;">Precio:</label>
      <input type="text" id="${seccion}-precio-${index}" value="${precio}" style="width: 100%; padding: 15px; font-size: 1.8rem; background: #000; border: 2px solid #ff18d0; border-radius: 20px; color: #00ff9f; margin-bottom: 15px;">
      <button onclick="eliminarProducto('${seccion}', ${index})" style="width: 100%; background: #ff18d0; border: none; border-radius: 20px; padding: 15px; font-size: 1.8rem; color: white; cursor: pointer;">üóëÔ∏è ELIMINAR</button>
    </div>
  `;
}

function cargarRefrescos() {
  let html = '';
  document.querySelectorAll('#panel-munchies .munchies-categoria:first-child .item-munchi').forEach((item, index) => {
    const nombre = item.querySelector('.item-nombre').textContent;
    const precio = item.querySelector('.item-precio').textContent;
    
    html += `
      <div style="background: #1a1a2a; border: 3px solid #ff18d0; border-radius: 30px; padding: 25px;">
        <label style="color: white; font-size: 1.8rem;">Producto:</label>
        <input type="text" id="refresco-nombre-${index}" value="${nombre}" style="width: 100%; padding: 15px; font-size: 1.8rem; background: #000; border: 2px solid #00ff9f; border-radius: 20px; color: white; margin-bottom: 15px;">
        <label style="color: white; font-size: 1.8rem;">Precio:</label>
        <input type="text" id="refresco-precio-${index}" value="${precio}" style="width: 100%; padding: 15px; font-size: 1.8rem; background: #000; border: 2px solid #ff18d0; border-radius: 20px; color: #00ff9f; margin-bottom: 15px;">
        <button onclick="eliminarMunchi('refrescos', ${index})" style="width: 100%; background: #ff18d0; border: none; border-radius: 20px; padding: 15px; font-size: 1.8rem; color: white; cursor: pointer;">üóëÔ∏è ELIMINAR</button>
      </div>
    `;
  });
  document.getElementById('refrescos-editables').innerHTML = html;
}

function cargarPicar() {
  let html = '';
  document.querySelectorAll('#panel-munchies .munchies-categoria:nth-child(2) .item-munchi').forEach((item, index) => {
    const nombre = item.querySelector('.item-nombre').textContent;
    const precio = item.querySelector('.item-precio').textContent;
    
    html += `
      <div style="background: #1a1a2a; border: 3px solid #ff18d0; border-radius: 30px; padding: 25px;">
        <label style="color: white; font-size: 1.8rem;">Producto:</label>
        <input type="text" id="picar-nombre-${index}" value="${nombre}" style="width: 100%; padding: 15px; font-size: 1.8rem; background: #000; border: 2px solid #00ff9f; border-radius: 20px; color: white; margin-bottom: 15px;">
        <label style="color: white; font-size: 1.8rem;">Precio:</label>
        <input type="text" id="picar-precio-${index}" value="${precio}" style="width: 100%; padding: 15px; font-size: 1.8rem; background: #000; border: 2px solid #ff18d0; border-radius: 20px; color: #00ff9f; margin-bottom: 15px;">
        <button onclick="eliminarMunchi('picar', ${index})" style="width: 100%; background: #ff18d0; border: none; border-radius: 20px; padding: 15px; font-size: 1.8rem; color: white; cursor: pointer;">üóëÔ∏è ELIMINAR</button>
      </div>
    `;
  });
  document.getElementById('picar-editables').innerHTML = html;
}

function cargarEventos() {
  let html = '';
  document.querySelectorAll('#panel-eventos .evento-card').forEach((card, index) => {
    const imgSrc = card.querySelector('img').src;
    
    html += `
      <div style="background: #1a1a2a; border: 3px solid #ffff00; border-radius: 30px; padding: 25px;">
        <div style="text-align: center; margin-bottom: 15px;">
          <img id="evento-img-${index}" src="${imgSrc}" style="width: 100%; max-height: 200px; object-fit: cover; border-radius: 20px; border: 4px solid #ffff00; cursor: pointer;" onclick="seleccionarImagenEvento(${index})">
          <div style="margin-top: 10px; color: #ffff00;">üëá TOCA LA IMAGEN</div>
        </div>
        <button onclick="eliminarEvento(${index})" style="width: 100%; background: #ff18d0; border: none; border-radius: 20px; padding: 15px; font-size: 1.8rem; color: white; cursor: pointer;">üóëÔ∏è ELIMINAR</button>
      </div>
    `;
  });
  document.getElementById('eventos-editables').innerHTML = html;
}

// ===== IM√ÅGENES =====
function seleccionarImagen(seccion, index) {
  productoEditando = { seccion, index };
  document.getElementById('selector-imagen').click();
}

function seleccionarImagenEvento(index) {
  productoEditando = { seccion: 'eventos', index };
  document.getElementById('selector-imagen').click();
}

document.getElementById('selector-imagen').addEventListener('change', function(e) {
  if (e.target.files && e.target.files[0] && productoEditando) {
    const reader = new FileReader();
    reader.onload = function(ev) {
      const preview = document.getElementById(`preview-${productoEditando.seccion}-${productoEditando.index}`);
      if (preview) preview.src = ev.target.result;
      
      let imagenes = localStorage.getItem('masquehigh_imagenes');
      imagenes = imagenes ? JSON.parse(imagenes) : {};
      imagenes[`${productoEditando.seccion}_${productoEditando.index}`] = ev.target.result;
      localStorage.setItem('masquehigh_imagenes', JSON.stringify(imagenes));
    };
    reader.readAsDataURL(e.target.files[0]);
  }
});

// ===== A√ëADIR PRODUCTOS =====
function anadirProductoEn(seccion) {
  let contenedor;
  let nuevoProducto;
  
  if (seccion === 'extract') {
    contenedor = document.querySelector('#panel-genero .subseccion:first-child .productos-grid');
    nuevoProducto = document.createElement('div');
    nuevoProducto.className = 'producto-card';
    nuevoProducto.innerHTML = '<img src="images/placeholder.jpg"><h4>NUEVA EXTRACCI√ìN</h4><div class="producto-precio">0‚Ç¨</div>';
  } else if (seccion === 'hierbas') {
    contenedor = document.querySelector('#panel-genero .subseccion:nth-child(2) .productos-grid');
    nuevoProducto = document.createElement('div');
    nuevoProducto.className = 'producto-card';
    nuevoProducto.innerHTML = '<img src="images/placeholder.jpg"><h4>NUEVA HIERBA</h4><div class="producto-precio">0‚Ç¨</div>';
  } else if (seccion === 'liados') {
    contenedor = document.querySelector('#panel-genero .subseccion:nth-child(3) .productos-grid');
    nuevoProducto = document.createElement('div');
    nuevoProducto.className = 'producto-card sin-imagen';
    nuevoProducto.innerHTML = '<h4>NUEVO LIADO</h4><div class="producto-precio">0‚Ç¨</div>';
  }
  
  if (contenedor && nuevoProducto) {
    contenedor.appendChild(nuevoProducto);
    cargarTodosLosDatos();
  }
}

function anadirMunchiEn(seccion) {
  let contenedor;
  let nuevoMunchi;
  
  if (seccion === 'refrescos') {
    contenedor = document.querySelector('#panel-munchies .munchies-categoria:first-child .items-lista');
    nuevoMunchi = document.createElement('div');
    nuevoMunchi.className = 'item-munchi';
    nuevoMunchi.innerHTML = '<span class="item-nombre">NUEVO REFRESCO</span><span class="item-precio">0‚Ç¨</span>';
  } else {
    contenedor = document.querySelector('#panel-munchies .munchies-categoria:nth-child(2) .items-lista');
    nuevoMunchi = document.createElement('div');
    nuevoMunchi.className = 'item-munchi';
    nuevoMunchi.innerHTML = '<span class="item-nombre">NUEVO PRODUCTO</span><span class="item-precio">0‚Ç¨</span>';
  }
  
  if (contenedor && nuevoMunchi) {
    contenedor.appendChild(nuevoMunchi);
    cargarTodosLosDatos();
  }
}

function anadirEvento() {
  const contenedor = document.querySelector('#panel-eventos .eventos-grid');
  const nuevoEvento = document.createElement('div');
  nuevoEvento.className = 'evento-card';
  nuevoEvento.innerHTML = '<img src="images/placeholder.jpg">';
  
  if (contenedor) {
    contenedor.appendChild(nuevoEvento);
    cargarTodosLosDatos();
  }
}

// ===== ELIMINAR =====
function eliminarProducto(seccion, index) {
  if (seccion === 'extract') {
    document.querySelectorAll('#panel-genero .subseccion:first-child .producto-card')[index]?.remove();
  } else if (seccion === 'hierbas') {
    document.querySelectorAll('#panel-genero .subseccion:nth-child(2) .producto-card')[index]?.remove();
  } else if (seccion === 'liados') {
    document.querySelectorAll('#panel-genero .subseccion:nth-child(3) .producto-card')[index]?.remove();
  }
  cargarTodosLosDatos();
}

function eliminarMunchi(seccion, index) {
  if (seccion === 'refrescos') {
    document.querySelectorAll('#panel-munchies .munchies-categoria:first-child .item-munchi')[index]?.remove();
  } else {
    document.querySelectorAll('#panel-munchies .munchies-categoria:nth-child(2) .item-munchi')[index]?.remove();
  }
  cargarTodosLosDatos();
}

function eliminarEvento(index) {
  document.querySelectorAll('#panel-eventos .evento-card')[index]?.remove();
  cargarTodosLosDatos();
}

// ===== GUARDAR =====
function guardarTodo() {
  // Guardar extracci√≥n
  document.querySelectorAll('#panel-genero .subseccion:first-child .producto-card').forEach((card, index) => {
    const nombre = document.getElementById(`extract-nombre-${index}`)?.value;
    const precio = document.getElementById(`extract-precio-${index}`)?.value;
    const img = document.getElementById(`preview-extract-${index}`)?.src;
    if (nombre) card.querySelector('h4').textContent = nombre;
    if (precio) card.querySelector('.producto-precio').textContent = precio;
    if (img) card.querySelector('img').src = img;
  });
  
  // Guardar hierbas
  document.querySelectorAll('#panel-genero .subseccion:nth-child(2) .producto-card').forEach((card, index) => {
    const nombre = document.getElementById(`hierbas-nombre-${index}`)?.value;
    const precio = document.getElementById(`hierbas-precio-${index}`)?.value;
    const img = document.getElementById(`preview-hierbas-${index}`)?.src;
    if (nombre) card.querySelector('h4').textContent = nombre;
    if (precio) card.querySelector('.producto-precio').textContent = precio;
    if (img) card.querySelector('img').src = img;
  });
  
  // Guardar liados
  document.querySelectorAll('#panel-genero .subseccion:nth-child(3) .producto-card').forEach((card, index) => {
    const nombre = document.getElementById(`liados-nombre-${index}`)?.value;
    const precio = document.getElementById(`liados-precio-${index}`)?.value;
    if (nombre) card.querySelector('h4').textContent = nombre;
    if (precio) card.querySelector('.producto-precio').textContent = precio;
  });
  
  // Guardar refrescos
  document.querySelectorAll('#panel-munchies .munchies-categoria:first-child .item-munchi').forEach((item, index) => {
    const nombre = document.getElementById(`refresco-nombre-${index}`)?.value;
    const precio = document.getElementById(`refresco-precio-${index}`)?.value;
    if (nombre) item.querySelector('.item-nombre').textContent = nombre;
    if (precio) item.querySelector('.item-precio').textContent = precio;
  });
  
  // Guardar picar
  document.querySelectorAll('#panel-munchies .munchies-categoria:nth-child(2) .item-munchi').forEach((item, index) => {
    const nombre = document.getElementById(`picar-nombre-${index}`)?.value;
    const precio = document.getElementById(`picar-precio-${index}`)?.value;
    if (nombre) item.querySelector('.item-nombre').textContent = nombre;
    if (precio) item.querySelector('.item-precio').textContent = precio;
  });
  
  // Guardar eventos
  document.querySelectorAll('#panel-eventos .evento-card').forEach((card, index) => {
    const img = document.getElementById(`evento-img-${index}`)?.src;
    if (img) card.querySelector('img').src = img;
  });
  
  // Guardar en localStorage
  const datos = {
    extract: [],
    hierbas: [],
    liados: [],
    refrescos: [],
    picar: []
  };
  
  document.querySelectorAll('#panel-genero .subseccion:first-child .producto-precio').forEach(e => datos.extract.push(e.textContent));
  document.querySelectorAll('#panel-genero .subseccion:nth-child(2) .producto-precio').forEach(e => datos.hierbas.push(e.textContent));
  document.querySelectorAll('#panel-genero .subseccion:nth-child(3) .producto-precio').forEach(e => datos.liados.push(e.textContent));
  document.querySelectorAll('#panel-munchies .munchies-categoria:first-child .item-precio').forEach(e => datos.refrescos.push(e.textContent));
  document.querySelectorAll('#panel-munchies .munchies-categoria:nth-child(2) .item-precio').forEach(e => datos.picar.push(e.textContent));
  
  localStorage.setItem('masquehigh_datos', JSON.stringify(datos));
  
  alert('‚úÖ TODO GUARDADO CORRECTAMENTE');
  cerrarAdmin();
}

// ===== CARGAR DATOS GUARDADOS =====
function cargarDatosGuardados() {
  const guardados = localStorage.getItem('masquehigh_datos');
  if (guardados) {
    const datos = JSON.parse(guardados);
    
    let index = 0;
    document.querySelectorAll('#panel-genero .subseccion:first-child .producto-precio').forEach(e => {
      if (datos.extract[index]) e.textContent = datos.extract[index];
      index++;
    });
    
    index = 0;
    document.querySelectorAll('#panel-genero .subseccion:nth-child(2) .producto-precio').forEach(e => {
      if (datos.hierbas[index]) e.textContent = datos.hierbas[index];
      index++;
    });
    
    index = 0;
    document.querySelectorAll('#panel-genero .subseccion:nth-child(3) .producto-precio').forEach(e => {
      if (datos.liados[index]) e.textContent = datos.liados[index];
      index++;
    });
    
    index = 0;
    document.querySelectorAll('#panel-munchies .munchies-categoria:first-child .item-precio').forEach(e => {
      if (datos.refrescos[index]) e.textContent = datos.refrescos[index];
      index++;
    });
    
    index = 0;
    document.querySelectorAll('#panel-munchies .munchies-categoria:nth-child(2) .item-precio').forEach(e => {
      if (datos.picar[index]) e.textContent = datos.picar[index];
      index++;
    });
  }
  
  const imagenes = localStorage.getItem('masquehigh_imagenes');
  if (imagenes) {
    const imgData = JSON.parse(imagenes);
    
    document.querySelectorAll('#panel-genero .subseccion:first-child .producto-card img').forEach((img, i) => {
      if (imgData[`extract_${i}`]) img.src = imgData[`extract_${i}`];
    });
    
    document.querySelectorAll('#panel-genero .subseccion:nth-child(2) .producto-card img').forEach((img, i) => {
      if (imgData[`hierbas_${i}`]) img.src = imgData[`hierbas_${i}`];
    });
    
    document.querySelectorAll('#panel-eventos .evento-card img').forEach((img, i) => {
      if (imgData[`eventos_${i}`]) img.src = imgData[`eventos_${i}`];
    });
  }
}

window.addEventListener('load', cargarDatosGuardados);
</script>
